#!/usr/bin/python3
import os

def generate_report(analysis_results, report_directory='../reports', report_filename='security_report.txt'):
    """
    Genererar en textbaserad rapport från analysresultaten.

    Args:
        analysis_results (dict): En dictionary med IP-adresser som nycklar och listor av riskbeskrivningar som värden.
        report_directory (str): Sökvägen till katalogen där rapportfilen ska sparas.
        report_filename (str): Namnet på rapportfilen.

    Returns:
        str: Sökvägen till den sparade rapportfilen.
    """
    # Skapa rapportkatalogen om den inte redan finns
    os.makedirs(report_directory, exist_ok=True)
    report_path = os.path.join(report_directory, report_filename)

    with open(report_path, 'w') as file:
        for ip, risks in analysis_results.items():
            file.write(f'Analysis for {ip}:\n')
            for risk in risks:
                file.write(f'- {risk}\n')
            file.write('\n') # Lägg till en tom rad för bättre läsbarhet mellan IP-adresserna

    print(f"Report has been saved to {report_path}")
    return report_path
