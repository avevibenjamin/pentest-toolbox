#!/usr/bin/python3
import os
from datetime import datetime

def generate_report(analysis_results, report_directory='../reports', report_base_filename='security_report'):
    """
    Genererar en textbaserad rapport från analysresultaten med datum- och tidsstämpel i filnamnet.
    """
    # Skapa rapportkatalogen om den inte redan finns
    os.makedirs(report_directory, exist_ok=True)
    timestamp = datetime.now().strftime('%Y-%m-%d_%H-%M-%S')
    report_filename = f"{report_base_filename}_{timestamp}.txt"
    report_path = os.path.join(report_directory, report_filename)

    try:
        with open(report_path, 'w') as file:
            for ip, risks in analysis_results.items():
                file.write(f'Analysis for {ip}:\n')
                for risk in risks:
                    file.write(f'- {risk}\n')
                file.write('\n') # Tom rad för bättre läsbarhet mellan IP-adresserna
        print(f"Report has been saved to {report_path}")
    except Exception as e:
        print(f"Failed to save report: {e}")
    
    return report_path

